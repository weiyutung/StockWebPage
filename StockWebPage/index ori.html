<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>股票分析平台</title>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
      const client = supabase.createClient(
        "https://sbzzfjlmhvuchzwqllgf.supabase.co",
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNienpmamxtaHZ1Y2h6d3FsbGdmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI3NDE2OTQsImV4cCI6MjA2ODMxNzY5NH0.fvDVLvGLQdMRuCMXmja8ltpXC3TcjZxq78xbnt9Bh-U"
      );
    </script>

    <link href="/static/style.css" rel="stylesheet" />
  </head>
  <body>
    <div id="main-content">
      <!-- 加一個「三槓選單」 -->
      <div class="menu-container" id="menuContainer">
        <div class="menu-icon">
          ☰
          <div class="dropdown" id="dropdownMenu">
            <div
              id="user-email"
              style="padding: 8px 15px; font-weight: bold"
            ></div>
            <a href="login.html" id="login-btn">登入</a>
            <a href="register.html" id="register-btn">註冊</a>
            <a href="#" id="logout-btn" onclick="logout()" style="display: none"
              >登出</a
            >
          </div>
        </div>
      </div>
      <div class="search-container">
        <input
          autocomplete="off"
          id="symbolInput"
          placeholder="輸入股票代號或名稱"
          type="text"
        />
        <div id="suggestions"></div>
      </div>
      <div>
        <h2
          id="chartTitle"
          style="text-align: left; font-weight: bold; margin: 0; padding: 0"
        ></h2>
        <div
          id="ohlcInfo"
          style="text-align: left; font-size: 16px; padding: 15px 0"
        ></div>
        <div class="time-range-bar">
          <div class="time-range-item" onclick="setActive(this, '5d')">5天</div>
          <div class="time-range-item" onclick="setActive(this, '1m')">1月</div>
          <div class="time-range-item" onclick="setActive(this, '3m')">3月</div>
          <div class="time-range-item" onclick="setActive(this, '6m')">6月</div>
          <div class="time-range-item" onclick="setActive(this, 'ytd')">
            YTD
          </div>
          <div class="time-range-item" onclick="setActive(this, '1y')">1年</div>
          <div class="time-range-item" onclick="setActive(this, '3y')">3年</div>
          <!-- 日曆按鈕與自訂時間容器 -->
          <div class="calendar-btn" onclick="toggleCustomDate()">
            <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M19 4h-1V2h-2v2H8V2H6v2H5C3.9 4 3 4.9 3 6v14c0 
        1.1.9 2 2 2h14c1.1 0 2-.9 
        2-2V6c0-1.1-.9-2-2-2zm0 
        16H5V9h14v11z"
              ></path>
            </svg>
          </div>
          <div id="customDateRange">
            起：<input id="customStart" type="date" /> 迄：<input
              id="customEnd"
              type="date"
            />
            <button onclick="loadStockWithRange(getSymbol(), 'custom')">
              查詢
            </button>
          </div>
          <label class="show-periods">
            <input
              id="togglePeriods"
              onchange="togglePeriods()"
              type="checkbox"
            />
            顯示時間區隔
          </label>
        </div>
        <div id="chartsWrap">
          <div id="priceChart"></div>
          <div id="volumeChart"></div>
        </div>
      </div>
    </div>
    <div
      id="main-chart-row"
      style="display: flex; align-items: stretch; min-height: 500px"
    >
      <!-- 右側功能（與圖表等高） -->
      <div
        style="
          margin-left: 10px;
          display: flex;
          flex-direction: column;
          margin-top: 250px;
        "
      >
        <div style="flex: 1; display: flex">
          <!-- 技術指標控制 -->
          <div style="width: 140px; flex: 1; padding: 5px">
            <h3 style="margin-top: 0">顯示技術線</h3>
            <div class="checkbox-group">
              <label
                ><input class="indicator-check" type="checkbox" value="Sma_5" />
                SMA 5</label
              >
              <label
                ><input
                  class="indicator-check"
                  type="checkbox"
                  value="Sma_10"
                />
                SMA 10</label
              >
              <label
                ><input
                  class="indicator-check"
                  type="checkbox"
                  value="Sma_20"
                />
                SMA 20</label
              >
              <label
                ><input
                  class="indicator-check"
                  type="checkbox"
                  value="Sma_60"
                />
                SMA 60</label
              >
              <label
                ><input
                  class="indicator-check"
                  type="checkbox"
                  value="Sma_120"
                />
                SMA 120</label
              >
              <label
                ><input
                  class="indicator-check"
                  type="checkbox"
                  value="Sma_240"
                />
                SMA 240</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="DIF" />
                DIF (快線)
              </label>
              <label
                ><input class="indicator-check" type="checkbox" value="DEA" />
                DEA (慢線)
              </label>
              <label
                ><input class="indicator-check" type="checkbox" value="K" />
                K</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="D" />
                D</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="J" />
                J</label
              >
              <label
                ><input class="indicator-check" type="checkbox" value="Bias" />
                Bias</label
              >
            </div>
          </div>
          <!-- 條件判斷區 -->
          <div style="width: 170px; flex: 1.5; padding: 5px">
            <h3 style="margin-top: 0">條件判斷</h3>
            <div class="checkbox-group">
              <label
                ><input class="rule-check" type="checkbox" value="sma-cross" />
                SMA 5 &gt; SMA 20</label
              >
              <label>
                <input class="rule-check" type="checkbox" value="three-red" />
                連續三天紅柱
              </label>
              <label>
                <input
                  class="rule-check"
                  type="checkbox"
                  value="three-down-volume"
                />
                成交量連降三天
              </label>
              <label
                ><input
                  class="rule-check"
                  type="checkbox"
                  value="dif-above-dea"
                />
                MACD：DIF突破DEA</label
              >
              <label
                ><input
                  class="rule-check"
                  type="checkbox"
                  value="dea-below-dif"
                />
                MACD：DEA跌破DIF</label
              >
              <label
                ><input class="rule-check" type="checkbox" value="kd-cross" />
                K上穿D 且 K&lt;20</label
              >
              <label
                ><input class="rule-check" type="checkbox" value="bias-high" />
                Bias &gt; 5</label
              >
              <label
                ><input class="rule-check" type="checkbox" value="bias-low" />
                Bias &lt; -5</label
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="/static/app.js"></script>
  </body>
</html>
